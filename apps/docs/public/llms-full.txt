# Janua API Documentation — Complete Reference

> Self-hosted OAuth2/OIDC authentication platform. Open-source Auth0/Clerk alternative built with FastAPI. 318+ API endpoints, 8 SDKs, SAML SSO, WebAuthn/Passkeys, enterprise RBAC. AGPL v3.

Janua is a self-hosted authentication platform providing complete identity management. The FastAPI backend exposes 318+ REST endpoints across 38 router modules. Authentication supports email/password, OAuth (8 providers), SAML 2.0 SSO, WebAuthn/Passkeys, magic links, and TOTP MFA. Enterprise features include multi-tenancy, RBAC, SCIM 2.0, webhooks, and compliance tooling (GDPR, SOC2, HIPAA, CCPA).

Base URL: https://api.janua.dev
OpenAPI Docs: https://api.janua.dev/docs
Documentation: https://docs.janua.dev
GitHub: https://github.com/madfam-org/janua

---

## Authentication

All API endpoints require HTTPS. Authentication uses RS256-signed JWT tokens.

```
Authorization: Bearer <access_token>
```

Token Types:
- Access tokens: RS256 JWT, default 480 minutes (configurable via JWT_ACCESS_TOKEN_EXPIRE_MINUTES)
- Refresh tokens: 7 days (configurable via JWT_REFRESH_TOKEN_EXPIRE_DAYS)
- JWKS endpoint: GET /.well-known/jwks.json

Password Requirements (default):
- Minimum 12 characters
- Uppercase, lowercase, numbers, and special characters required

---

## Core Authentication Endpoints

### POST /api/v1/auth/signup
Create a new user account.

```bash
curl -X POST https://api.janua.dev/api/v1/auth/signup \
  -H "Content-Type: application/json" \
  -d '{
    "email": "user@example.com",
    "password": "SecurePass123!",
    "first_name": "Jane",
    "last_name": "Developer"
  }'
```

Response (201):
```json
{
  "id": "uuid",
  "email": "user@example.com",
  "first_name": "Jane",
  "last_name": "Developer",
  "email_verified": false,
  "message": "Verification email sent"
}
```

### POST /api/v1/auth/signin
Authenticate and receive JWT tokens.

```bash
curl -X POST https://api.janua.dev/api/v1/auth/signin \
  -H "Content-Type: application/json" \
  -d '{
    "email": "user@example.com",
    "password": "SecurePass123!"
  }'
```

Response (200):
```json
{
  "access_token": "eyJhbGciOiJSUzI1NiIs...",
  "refresh_token": "eyJhbGciOiJSUzI1NiIs...",
  "token_type": "bearer",
  "expires_in": 28800,
  "user": {
    "id": "uuid",
    "email": "user@example.com",
    "first_name": "Jane"
  }
}
```

If MFA is enabled:
```json
{
  "mfa_required": true,
  "mfa_token": "temporary-mfa-token",
  "mfa_methods": ["totp"]
}
```

### POST /api/v1/auth/token/refresh
Refresh an expired access token.

```bash
curl -X POST https://api.janua.dev/api/v1/auth/token/refresh \
  -H "Content-Type: application/json" \
  -d '{"refresh_token": "eyJhbGciOiJSUzI1NiIs..."}'
```

### GET /api/v1/auth/me
Get current authenticated user.

```bash
curl https://api.janua.dev/api/v1/auth/me \
  -H "Authorization: Bearer <access_token>"
```

### POST /api/v1/auth/password/reset
Request password reset email.

```bash
curl -X POST https://api.janua.dev/api/v1/auth/password/reset \
  -H "Content-Type: application/json" \
  -d '{"email": "user@example.com"}'
```

### POST /api/v1/auth/magic-link
Send passwordless magic link.

```bash
curl -X POST https://api.janua.dev/api/v1/auth/magic-link \
  -H "Content-Type: application/json" \
  -d '{"email": "user@example.com"}'
```

---

## OAuth Social Login

### GET /api/v1/auth/oauth/{provider}/authorize
Redirect user to OAuth provider. Supported providers: google, github, microsoft, apple, discord, twitter, linkedin, slack.

```bash
curl https://api.janua.dev/api/v1/auth/oauth/google/authorize?redirect_uri=https://myapp.com/callback
```

### GET /api/v1/auth/oauth/{provider}/callback
Handle OAuth callback with authorization code.

---

## Multi-Factor Authentication

### POST /api/v1/mfa/totp/enable
Enable TOTP MFA for authenticated user. Returns QR code and secret.

```bash
curl -X POST https://api.janua.dev/api/v1/mfa/totp/enable \
  -H "Authorization: Bearer <access_token>"
```

### POST /api/v1/mfa/verify
Verify TOTP code during login.

```bash
curl -X POST https://api.janua.dev/api/v1/mfa/verify \
  -H "Content-Type: application/json" \
  -d '{"mfa_token": "temporary-mfa-token", "code": "123456"}'
```

### GET /api/v1/mfa/backup-codes
Generate backup recovery codes.

---

## WebAuthn/Passkeys

### POST /api/v1/passkeys/register/begin
Start passkey registration (returns challenge and options).

### POST /api/v1/passkeys/register/complete
Complete registration with authenticator response.

### POST /api/v1/passkeys/authenticate/begin
Start passkey authentication.

### POST /api/v1/passkeys/authenticate/complete
Complete authentication and receive JWT.

---

## User Management

### GET /api/v1/users
List users (admin only). Supports pagination, search, filtering.

```bash
curl https://api.janua.dev/api/v1/users?page=1&per_page=20&search=jane \
  -H "Authorization: Bearer <admin_token>"
```

### GET /api/v1/users/{user_id}
Get user details.

### PATCH /api/v1/users/{user_id}
Update user profile.

### DELETE /api/v1/users/{user_id}
Delete/deactivate user.

---

## Organizations (Multi-Tenancy)

### POST /api/v1/organizations
Create organization.

```bash
curl -X POST https://api.janua.dev/api/v1/organizations \
  -H "Authorization: Bearer <access_token>" \
  -H "Content-Type: application/json" \
  -d '{"name": "Acme Corp", "slug": "acme-corp"}'
```

### GET /api/v1/organizations
List user's organizations.

### POST /api/v1/organizations/{org_id}/members
Add member to organization.

### PUT /api/v1/organizations/{org_id}/members/{user_id}/role
Update member role.

---

## SAML SSO

### POST /api/v1/sso/configurations
Create SSO configuration for an organization.

```bash
curl -X POST https://api.janua.dev/api/v1/sso/configurations \
  -H "Authorization: Bearer <admin_token>" \
  -H "Content-Type: application/json" \
  -d '{
    "organization_id": "org-uuid",
    "provider": "okta",
    "idp_metadata_url": "https://dev-123456.okta.com/app/abc/sso/saml/metadata"
  }'
```

### GET /api/v1/sso/initiate
Initiate SSO login for organization.

### POST /api/v1/sso/acs
SAML Assertion Consumer Service endpoint.

---

## SCIM 2.0 Provisioning

### GET /scim/v2/Users
List provisioned users (SCIM format).

### POST /scim/v2/Users
Create user via SCIM.

### PATCH /scim/v2/Users/{id}
Update user attributes via SCIM PATCH.

### GET /scim/v2/Groups
List groups.

### POST /scim/v2/Groups
Create group.

### GET /scim/v2/ServiceProviderConfig
SCIM service provider configuration.

---

## RBAC & Permissions

### GET /api/v1/rbac/check
Check if user has permission.

```bash
curl "https://api.janua.dev/api/v1/rbac/check?permission=users:write&resource_id=org-uuid" \
  -H "Authorization: Bearer <access_token>"
```

### GET /api/v1/roles
List available roles.

### POST /api/v1/roles
Create custom role.

---

## Webhooks

### POST /api/v1/webhooks
Create webhook subscription.

```bash
curl -X POST https://api.janua.dev/api/v1/webhooks \
  -H "Authorization: Bearer <admin_token>" \
  -H "Content-Type: application/json" \
  -d '{
    "url": "https://myapp.com/webhooks/janua",
    "events": ["user.created", "user.updated", "session.created"]
  }'
```

### GET /api/v1/webhooks/{id}/deliveries
List webhook delivery history.

---

## Compliance

### POST /api/v1/compliance/data-export
Export user data (GDPR data portability).

### POST /api/v1/compliance/data-deletion
Request data deletion (GDPR right to erasure).

### GET /api/v1/compliance/consent
Get user consent records.

---

## Health Endpoints

### GET /health
Basic health check.
```bash
curl https://api.janua.dev/health
# → {"status": "healthy"}
```

### GET /health/detailed
Detailed health with dependency status.
```bash
curl https://api.janua.dev/health/detailed
# → {"status": "healthy", "database": true, "redis": true, "kms": true}
```

### GET /health/ready
Kubernetes readiness probe.

### GET /health/live
Kubernetes liveness probe.

---

## Admin Endpoints (23 Endpoints)

### GET /api/v1/admin/stats
Platform statistics (users, organizations, sessions).

### GET /api/v1/admin/activity
Recent platform activity.

### POST /api/v1/admin/maintenance
Toggle maintenance mode.

### GET /api/v1/admin/system/config
Get system configuration.

---

## Error Handling

All errors follow a consistent format:
```json
{
  "detail": "Human-readable error message",
  "error_code": "AUTHENTICATION_ERROR",
  "status_code": 401
}
```

| HTTP | Code | Meaning |
|------|------|---------|
| 400 | BAD_REQUEST | Invalid request |
| 401 | AUTHENTICATION_ERROR | Invalid credentials |
| 401 | TOKEN_ERROR | Invalid/expired JWT |
| 403 | AUTHORIZATION_ERROR | Permission denied |
| 404 | NOT_FOUND_ERROR | Resource not found |
| 409 | CONFLICT_ERROR | Duplicate resource |
| 422 | VALIDATION_ERROR | Validation failed |
| 429 | RATE_LIMIT_ERROR | Rate limited |
| 500 | INTERNAL_ERROR | Server error |

---

## SDK Quick Start

### React
```tsx
import { JanuaProvider, useAuth } from '@janua/react-sdk';

function App() {
  return (
    <JanuaProvider baseURL="https://api.janua.dev">
      <YourApp />
    </JanuaProvider>
  );
}

function Profile() {
  const { user, signOut, isAuthenticated } = useAuth();
  if (!isAuthenticated) return <div>Please sign in</div>;
  return <div>Welcome, {user?.email} <button onClick={signOut}>Sign Out</button></div>;
}
```

### Next.js (App Router)
```typescript
// middleware.ts
import { withJanuaAuth } from '@janua/nextjs-sdk';
export default withJanuaAuth({ publicRoutes: ['/'] });

// app/api/auth/[...janua]/route.ts
import { JanuaNextAuth } from '@janua/nextjs-sdk';
export const { GET, POST } = JanuaNextAuth({
  baseURL: process.env.JANUA_API_URL!,
});
```

### Python
```python
from janua import JanuaClient

client = JanuaClient(base_url="https://api.janua.dev")
result = await client.auth.sign_in(email="user@example.com", password="SecurePass123!")
user = await client.users.get_current_user()
```

### Go
```go
import "github.com/madfam-org/janua/packages/go-sdk/janua"

client := janua.NewClient("https://api.janua.dev")
result, err := client.Auth.SignIn(ctx, "user@example.com", "SecurePass123!")
```

### Vue 3
```vue
<script setup>
import { useAuth } from '@janua/vue-sdk';
const { user, signIn, signOut, isAuthenticated } = useAuth();
</script>
```

### Install Commands
```bash
npm install @janua/react-sdk       # React
npm install @janua/nextjs-sdk      # Next.js
npm install @janua/vue-sdk         # Vue 3
npm install @janua/typescript-sdk  # TypeScript (core)
pip install janua-sdk              # Python
go get github.com/madfam-org/janua/packages/go-sdk  # Go
```

NPM Registry (for @janua/* packages):
```
@janua:registry=https://npm.madfam.io
//npm.madfam.io/:_authToken=${NPM_MADFAM_TOKEN}
```

---

## Rate Limiting

Default limits (configurable via environment variables):
- 60 requests per minute per IP
- 1,000 requests per hour per IP
- Whitelist: configurable via RATE_LIMIT_WHITELIST

Rate limit headers returned:
```
X-RateLimit-Limit: 60
X-RateLimit-Remaining: 55
X-RateLimit-Reset: 1706745600
```

---

## Security Features

- RS256 JWT with automatic key rotation
- Field-level Fernet encryption for sensitive data (MFA secrets, backup codes)
- bcrypt password hashing (12 rounds)
- Account lockout after 5 failed attempts (15-minute lockout)
- CORS with configurable origins
- Rate limiting per IP
- CSRF protection
- Cloudflare Turnstile integration (optional)
- Audit logging for all security events
- WebAuthn/FIDO2 passkey support
- SAML 2.0 assertion validation

---

## Migration from Auth0

Automated migration tool saves $24,000-58,000/year:

```bash
cd scripts/migration
pip install -r requirements.txt
python auth0_migrate.py --config config.json
```

Features:
- Export all users from Auth0 Management API
- Automatic data mapping to Janua schema
- Preserves email, name, phone, metadata
- Migration progress tracking and reporting
- Zero-downtime migration strategy guide

Note: Password hashes cannot be exported from Auth0. Users reset passwords on first login.

---

*Generated: February 2026 | Janua v1.0 | Production at api.janua.dev*
*See llms.txt for concise navigation index*
