# Plinto Production Environment Configuration
# This is a complete production configuration template
# Copy to .env.production and update with actual values

# ============================================
# CORE ENVIRONMENT
# ============================================
NODE_ENV=production
ENVIRONMENT=production
LOG_LEVEL=info
DEBUG=false

# ============================================
# DATABASE (PostgreSQL on Railway)
# ============================================
DATABASE_URL=postgresql://user:password@region.railway.app:5432/plinto_prod
DATABASE_POOL_SIZE=50
DATABASE_MAX_OVERFLOW=20
DATABASE_STATEMENT_TIMEOUT=30000
DATABASE_SSL_MODE=require

# ============================================
# REDIS (Railway)
# ============================================
REDIS_URL=redis://default:password@region.railway.app:6379
REDIS_POOL_SIZE=20
REDIS_MAX_CONNECTIONS=100
REDIS_CONNECTION_TIMEOUT=5000

# ============================================
# API CONFIGURATION
# ============================================
API_BASE_URL=https://plinto.dev/api/v1
NEXT_PUBLIC_API_URL=https://plinto.dev/api/v1
API_VERSION=v1
API_DOCS_ENABLED=false  # Disable Swagger in production
API_MAX_REQUEST_SIZE=10485760  # 10MB

# ============================================
# JWT & AUTHENTICATION
# ============================================
# Store these securely (AWS Secrets Manager, Railway variables, etc.)
JWT_PRIVATE_KEY=${JWT_PRIVATE_KEY_FROM_SECRETS}
JWT_PUBLIC_KEY=${JWT_PUBLIC_KEY_FROM_SECRETS}
JWT_ALGORITHM=RS256
JWT_ISSUER=https://plinto.dev
JWT_AUDIENCE=plinto.dev
JWT_ACCESS_TOKEN_EXPIRE_MINUTES=15
JWT_REFRESH_TOKEN_EXPIRE_DAYS=30
JWT_REVOCATION_CHECK_ENABLED=true

# ============================================
# SECURITY
# ============================================
SECRET_KEY=${SECRET_KEY_FROM_SECRETS}  # Min 32 chars
BCRYPT_ROUNDS=12
PASSWORD_MIN_LENGTH=8
PASSWORD_REQUIRE_UPPERCASE=true
PASSWORD_REQUIRE_LOWERCASE=true
PASSWORD_REQUIRE_NUMBERS=true
PASSWORD_REQUIRE_SPECIAL=true
SESSION_COOKIE_SECURE=true
SESSION_COOKIE_HTTPONLY=true
SESSION_COOKIE_SAMESITE=strict
SESSION_COOKIE_DOMAIN=.plinto.dev

# ============================================
# CORS
# ============================================
CORS_ORIGINS=["https://plinto.dev","https://app.plinto.dev","https://admin.plinto.dev","https://docs.plinto.dev"]
CORS_ALLOW_CREDENTIALS=true
CORS_MAX_AGE=86400

# ============================================
# RATE LIMITING
# ============================================
RATE_LIMIT_ENABLED=true
RATE_LIMIT_DEFAULT=100  # Per minute per IP
RATE_LIMIT_WINDOW_SECONDS=60
RATE_LIMIT_TENANT_COMMUNITY=100
RATE_LIMIT_TENANT_PRO=1000
RATE_LIMIT_TENANT_SCALE=5000
RATE_LIMIT_TENANT_ENTERPRISE=10000
RATE_LIMIT_WHITELIST=[]  # Internal IPs
RATE_LIMIT_BLACKLIST=[]  # Blocked IPs

# ============================================
# EMAIL SERVICE (SendGrid)
# ============================================
EMAIL_ENABLED=true
EMAIL_PROVIDER=sendgrid
EMAIL_FROM_ADDRESS=noreply@plinto.dev
EMAIL_FROM_NAME=Plinto Security
EMAIL_REPLY_TO=support@plinto.dev
SENDGRID_API_KEY=${SENDGRID_API_KEY_FROM_SECRETS}
SENDGRID_WEBHOOK_SECRET=${SENDGRID_WEBHOOK_SECRET_FROM_SECRETS}

# ============================================
# PAYMENT PROVIDERS
# ============================================
# Conekta (Mexico)
PAYMENT_PROVIDER_MX=conekta
CONEKTA_PRIVATE_KEY=${CONEKTA_PRIVATE_KEY_FROM_SECRETS}
CONEKTA_PUBLIC_KEY=${CONEKTA_PUBLIC_KEY_FROM_SECRETS}
CONEKTA_WEBHOOK_SECRET=${CONEKTA_WEBHOOK_SECRET_FROM_SECRETS}
CONEKTA_SANDBOX=false

# Fungies.io (International MoR)
PAYMENT_PROVIDER_INTL=fungies
FUNGIES_API_KEY=${FUNGIES_API_KEY_FROM_SECRETS}
FUNGIES_WEBHOOK_SECRET=${FUNGIES_WEBHOOK_SECRET_FROM_SECRETS}
FUNGIES_MERCHANT_ID=${FUNGIES_MERCHANT_ID}
FUNGIES_SANDBOX=false

# ============================================
# WEBAUTHN / PASSKEYS
# ============================================
WEBAUTHN_RP_ID=plinto.dev
WEBAUTHN_RP_NAME=Plinto
WEBAUTHN_ORIGIN=https://plinto.dev
WEBAUTHN_ATTESTATION=none
WEBAUTHN_USER_VERIFICATION=preferred
WEBAUTHN_TIMEOUT=60000

# ============================================
# CLOUDFLARE SERVICES
# ============================================
# Turnstile (Bot Protection)
CLOUDFLARE_TURNSTILE_SITE_KEY=${CF_TURNSTILE_SITE_KEY}
CLOUDFLARE_TURNSTILE_SECRET=${CF_TURNSTILE_SECRET_FROM_SECRETS}
CLOUDFLARE_TURNSTILE_ENABLED=true

# R2 Storage
CLOUDFLARE_ACCOUNT_ID=${CF_ACCOUNT_ID}
CLOUDFLARE_R2_ENDPOINT=https://${CF_ACCOUNT_ID}.r2.cloudflarestorage.com
CLOUDFLARE_R2_ACCESS_KEY=${CF_R2_ACCESS_KEY_FROM_SECRETS}
CLOUDFLARE_R2_SECRET_KEY=${CF_R2_SECRET_KEY_FROM_SECRETS}
CLOUDFLARE_R2_AUDIT_BUCKET=plinto-audit-logs-prod
CLOUDFLARE_R2_EXPORT_BUCKET=plinto-exports-prod
CLOUDFLARE_R2_BACKUP_BUCKET=plinto-backups-prod

# Workers KV
CLOUDFLARE_KV_NAMESPACE_ID=${CF_KV_NAMESPACE_ID}
CLOUDFLARE_KV_API_TOKEN=${CF_KV_API_TOKEN_FROM_SECRETS}

# ============================================
# MONITORING & OBSERVABILITY
# ============================================
# Sentry
SENTRY_DSN=${SENTRY_DSN_FROM_SECRETS}
SENTRY_ENVIRONMENT=production
SENTRY_TRACES_SAMPLE_RATE=0.1
SENTRY_PROFILES_SAMPLE_RATE=0.1

# DataDog / New Relic / Custom
MONITORING_ENABLED=true
MONITORING_PROVIDER=datadog
DATADOG_API_KEY=${DATADOG_API_KEY_FROM_SECRETS}
DATADOG_APP_KEY=${DATADOG_APP_KEY_FROM_SECRETS}
DATADOG_SITE=datadoghq.com

# OpenTelemetry
OPENTELEMETRY_ENABLED=true
OPENTELEMETRY_ENDPOINT=https://otel.plinto.dev
OPENTELEMETRY_SERVICE_NAME=plinto-api
OPENTELEMETRY_TRACES_ENABLED=true
OPENTELEMETRY_METRICS_ENABLED=true
OPENTELEMETRY_LOGS_ENABLED=true

# ============================================
# ALERTING
# ============================================
ALERT_ENABLED=true
ALERT_CHANNELS=["slack","email","pagerduty"]

# Slack
ALERT_SLACK_WEBHOOK=${SLACK_WEBHOOK_FROM_SECRETS}
ALERT_SLACK_CHANNEL=#plinto-alerts
ALERT_SLACK_USERNAME=Plinto Bot

# Email
ALERT_EMAIL_TO=oncall@plinto.dev,security@plinto.dev
ALERT_EMAIL_FROM=alerts@plinto.dev

# PagerDuty
PAGERDUTY_INTEGRATION_KEY=${PAGERDUTY_KEY_FROM_SECRETS}
PAGERDUTY_SEVERITY_MAPPING={"critical":"critical","error":"error","warning":"warning","info":"info"}

# ============================================
# WEBHOOKS
# ============================================
WEBHOOK_ENABLED=true
WEBHOOK_SIGNING_SECRET=${WEBHOOK_SECRET_FROM_SECRETS}
WEBHOOK_RETRY_ATTEMPTS=3
WEBHOOK_RETRY_DELAY_SECONDS=60
WEBHOOK_TIMEOUT_SECONDS=30
WEBHOOK_MAX_PAYLOAD_SIZE=1048576  # 1MB

# ============================================
# FEATURE FLAGS
# ============================================
FEATURE_PASSKEYS_ENABLED=true
FEATURE_MFA_ENABLED=true
FEATURE_TOTP_ENABLED=true
FEATURE_SMS_MFA_ENABLED=false  # Coming soon
FEATURE_SOCIAL_LOGIN_ENABLED=true
FEATURE_ORGANIZATIONS_ENABLED=true
FEATURE_RBAC_ENABLED=true
FEATURE_AUDIT_LOGGING_ENABLED=true
FEATURE_WEBHOOKS_ENABLED=true
FEATURE_SSO_ENABLED=true
FEATURE_SCIM_ENABLED=true
FEATURE_API_KEYS_ENABLED=true
FEATURE_DEVICE_MANAGEMENT_ENABLED=true

# ============================================
# TENANT DEFAULTS
# ============================================
DEFAULT_TENANT_PLAN=community
DEFAULT_TENANT_TRIAL_DAYS=14
DEFAULT_MAX_MAU=2000
DEFAULT_MAX_ORGANIZATIONS=1
DEFAULT_MAX_API_CALLS_PER_MONTH=100000
DEFAULT_MAX_TEAM_MEMBERS=5
DEFAULT_DATA_RETENTION_DAYS=90

# ============================================
# INFRASTRUCTURE
# ============================================
# Railway
RAILWAY_ENVIRONMENT=production
RAILWAY_PROJECT_ID=${RAILWAY_PROJECT_ID}
RAILWAY_SERVICE_ID=${RAILWAY_SERVICE_ID}
RAILWAY_DEPLOYMENT_ID=${RAILWAY_DEPLOYMENT_ID}

# Vercel
VERCEL_ENV=production
VERCEL_URL=https://plinto.dev
VERCEL_GIT_COMMIT_SHA=${VERCEL_GIT_COMMIT_SHA}
VERCEL_GIT_COMMIT_REF=${VERCEL_GIT_COMMIT_REF}

# CDN
CDN_ENABLED=true
CDN_PROVIDER=cloudflare
CDN_BASE_URL=https://cdn.plinto.dev
STATIC_ASSETS_URL=https://static.plinto.dev

# ============================================
# BACKUP & DISASTER RECOVERY
# ============================================
BACKUP_ENABLED=true
BACKUP_SCHEDULE="0 2 * * *"  # 2 AM daily
BACKUP_RETENTION_DAYS=30
BACKUP_PROVIDER=r2
BACKUP_ENCRYPTION_ENABLED=true
BACKUP_ENCRYPTION_KEY=${BACKUP_KEY_FROM_SECRETS}

# ============================================
# COMPLIANCE & AUDIT
# ============================================
AUDIT_LOG_ENABLED=true
AUDIT_LOG_RETENTION_DAYS=2555  # 7 years
AUDIT_LOG_HASH_CHAIN=true
AUDIT_LOG_ENCRYPTION=true
GDPR_ENABLED=true
GDPR_DATA_RETENTION_DAYS=365
GDPR_RIGHT_TO_ERASURE=true
CCPA_ENABLED=true
SOC2_COMPLIANCE_MODE=true

# ============================================
# PERFORMANCE
# ============================================
CACHE_ENABLED=true
CACHE_TTL_SECONDS=300
CACHE_PROVIDER=redis
RESPONSE_COMPRESSION=true
CONNECTION_POOLING=true
QUERY_OPTIMIZATION=true
LAZY_LOADING=true

# ============================================
# REGIONAL CONFIGURATION
# ============================================
PRIMARY_REGION=us-east-1
SECONDARY_REGIONS=["us-west-2","eu-west-1"]
DATA_RESIDENCY_ENABLED=true
MULTI_REGION_FAILOVER=true